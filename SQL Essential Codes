#calculated field
select city, gender, height, weight, height/weight
from patients;

#naming calculated field
#method 1
select city, gender, height, weight, height/weight 'portion'
from patients;

#method 2 = add as
select city, gender, height, weight, height/weight as 'portion method 2'
from patients;

#Add select only some row with conditions = WHERE
#this is the same as filter in excel
#filter numerical value
select *
from patients
where height >= 150;

#filter string value
select *
from patients
where gender = 'M'
order by height desc, weight desc;

#Filter 2 conditions = WHERE + AND ***********
select *
from patients
where gender = 'F' AND height > 170
order by height desc, weight desc;

#Filter with datetime column******
#datetime format in SQL = YY-MM-DD ******
select *
from patients
where gender = 'M' AND birth_date > '2000-01-01'
order by height desc, weight desc;

#Extract only year portion of datetime using year() function******
#If type only year, it is number not string like full datetime
select *
from patients
where gender = 'M' AND year(birth_date) = 2000
order by height desc, weight desc; 

#Filter with rows in between 2 values (> a but < b)
#Method 1 = where + and
select *
from patients
where height >= 170 AND height < 200
order by height desc, weight desc;

#Method 2 = where + between + and
select *
from patients
where height BETWEEN 170 AND 200
order by height desc, weight desc;

#Filter with 3 conditions
select *
from patients
where gender = 'M' AND height > 170 AND height < 200
order by height desc, weight desc; 

#Filter with 3 conditions with BETWEEN
select *
from patients
where gender = 'M' AND height BETWEEN 170 AND 200
order by height desc, weight desc; 

#Filter with OR conditions
SELECT * 
FROM patients
WHERE gender = 'M' or weight >= 70
order by weight desc

#Filter with many conditions from single column = using WHERE + IN()
#suitable for scenartio with many conditions to write to save time*******
SELECT *
FROM patients
WHERE city IN ('Hamilton', 'Athens', 'Dundas')
ORDER BY weight DESC;



#Sorting = ORDER BY
#Ascending = min >> max
select *
from patients
where height > 160
order by height;

#Descening = max >> min
select *
from patients
where height > 160
order by height desc;

#ORDER BY 2 columns
#1 column ascending, 1 column descending
select *
from patients
where height > 170
order by height, weight desc;

#BOTH columns descending
select *
from patients
where height > 180
order by height desc, weight desc;

#Extract weekday(monday - Friday) out of datetime column using weekday() 
#0 = monday, 6 = sunday
select birth_date, gender, height, weight, weekday(birth_date) as 'Day_in_week'
from patients
where weekday(birth_date) = 0
order by height desc, weight desc; 

#Filter only when start with specific letter = using WHERE + LIKE + a%
SELECT *
FROM patients
WHERE first_name LIKE 'J%'
ORDER BY first_name DESC;

#Filter only when contain specific letter = using WHERE + LIKE + %a%
SELECT *
FROM patients
WHERE first_name LIKE '%in%'
ORDER BY first_name DESC;

#IF condition = CASE + WHEN + THEN + ELSE + END + AS
#********CASE WHEN needs to be after SELECT and before FROM only!!
SELECT height, weight 
	case WHEN weight < 60 THEN 'slim' 
    	WHEN weight < 70 THEN 'medium' 
        WHEN weight < 100 THEN 'fat' 
        ELSE 'diabete' 
END AS 'body_type'
FROM patients;



